{% extends 'adminlte/base.html' %}

{% load static %}

{% block title %}My App{% endblock %}

{% block content %}

     <form>

        <select id="filial" name="filial">
            {% for i in branches %}
                <option value="{{ i.id }}">{{ i }}</option>
            {% endfor %}
        </select>

        <select id="locomotive" name="locomotive">
            {% for i in locomotives %}
                <option value="{{ i.id }}">{{ i }}</option>
            {% endfor %}
        </select>
        <select id="period" name="period" class="select">
            {% for i in periods %}
                <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
        </select>

{#        Филиал: {{ form.filial }}    Серия: {{ form.locomotive }}    Год: {{ form.period }}#}
        <input type="submit">
    </form>
    <script>
        var totalCost = 0;
    </script>
    {{ chart_period }} vasya
    {% for i in locomotives %}
        {% for j in periods %}
{#            {{ j.year }}sdfsgsdg{{ chart_period }}#}
            {% if j.year == chart_period %}
                {% if j.locomotive_id == i.id %}
                    <p>{{ i.name }}; rate={{ i.rate }}; run={{ j.run }}; </p>
                    <script>
                        var cost = (+{{ i.rate }} * +{{ j.run }})
                        totalCost += cost
                        document.write("<p>" + "cost= " + cost + "</p>")
                        document.write("<p>" + "total =  " + totalCost + "</p>")
                        {#document.write("<p>" + "aaaaa =  " + {{ j.year }} + "</p>")#}
                    </script>
                {% endif %}
            {% else %}
            {% endif %}
        {% endfor %}
        <script>
    var barChartData = {
		labels : [{{ chart_period }}],
		datasets : [
			{
				fillColor : "rgba(220,220,220,0.5)",
				strokeColor : "rgba(220,220,220,0.8)",
				highlightFill: "rgba(220,220,220,0.75)",
				highlightStroke: "rgba(220,220,220,1)",
				data : [totalCost]
			},
			{#{#}
			{#	fillColor : "rgba(151,187,205,0.5)",#}
			{#	strokeColor : "rgba(151,187,205,0.8)",#}
			{#	highlightFill : "rgba(151,187,205,0.75)",#}
			{#	highlightStroke : "rgba(151,187,205,1)",#}
			{#	data : [randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]#}
			{# } #}
		]

	}
	window.onload = function(){
		var ctx = document.getElementById("canvas").getContext("2d");
		window.myBar = new Chart(ctx).Bar(barChartData, {
			responsive : true
		});
	}

	</script>
    {% endfor %}

    total cost= one symbol
<canvas id="canvas" height="450" width="600"></canvas>

{% endblock %}

{% block javascript %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="{% static 'js/chart.js/Chart.js' %}"></script>
    <script src="{% static 'js/chart.js/Chart.min.js' %}"></script>
    <script src="{% static 'js/ajax.js' %}"></script>
{% endblock %}